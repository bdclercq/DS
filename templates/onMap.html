<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>New Age - Start Bootstrap Theme</title>

    <style>
        #map {
            width: 90%;
            height: 85%;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }

        table {
            font-family: arial, sans-serif;
            border-collapse: collapse;
            width: 100%;
        }

        td, th {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 8px;
        }

        tr:nth-child(even) {
            background-color: #dddddd;
        }
    </style>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css"
          integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
          crossorigin=""/>
    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js"
            integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA=="
            crossorigin=""></script>

    <meta name="viewport" content="initial-scale=1.0,
    width=device-width" />
    <script src="http://js.api.here.com/v3/3.0/mapsjs-core.js"
    type="text/javascript" charset="utf-8"></script>
    <script src="http://js.api.here.com/v3/3.0/mapsjs-service.js"
    type="text/javascript" charset="utf-8"></script>

    <!-- Bootstrap core CSS -->
    <link href="{{ url_for('static', filename='vendor/bootstrap/css/bootstrap.min.css')}}" rel="stylesheet">
    <!-- Custom fonts for this template -->
    <link href="{{ url_for('static', filename='vendor/fontawesome-free/css/all.min.css')}}" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='vendor/simple-line-icons/css/simple-line-icons.css')}}">
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Catamaran:100,200,300,400,500,600,700,800,900" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Muli" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="{{ url_for('static', filename='css/new-age.min.css')}}" rel="stylesheet">

</head>

<body id="page-top">

<!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
    <div class="container">
        <!--<a class="navbar-brand js-scroll-trigger" href="#page-top">Start Bootstrap</a>-->
    </div>
</nav>

<header class="masthead">

    <!--<div class="container">-->
        <!--<div class="row">-->
            <!--<div class="col-lg-7 my-auto">-->
                <!--<div class="header-content mx-auto">-->
                    <!--<h1 class="mb-5">-->
                        <br>
                        <div id="map" ></div>
                        <script>

                            var platform = new H.service.Platform({
                              app_id: 'lLhrUyfFEtsQcqQygfnX',     //set your app_id
                              app_code: 'XpBpGZrvaawH8C_H6N0KEQ',   //set your app_code
                              useCIT: true         //configure all services to use the 'CIT' environment
                            });

                            function calculateRoute(platform, wp0, wp1) {
                              var router = platform.getRoutingService(),
                                parameters = {
                                  waypoint0: wp0.lat + "," + wp0.lng ,
                                  waypoint1: wp1.lat + "," + wp1.lng,
                                  mode: 'balanced;publicTransport',
                                  departure: 'now'};

                              router.calculateRoute(parameters,
                                function (result) {
                                  var obj = JSON.parse(JSON.stringify(result));
                                  console.log(obj);
                                }, function (error) {
                                  alert(error);
                                });
                            }

                            var map = L.map('map', {
                                center: [51.219448, 4.402464],
                                zoom: 15
                            });
                            L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
                                attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
                            }).addTo(map);

                            var markers = {};
                            // var marker = L.marker([51.5, -0.09]).addTo(mymap); var lat = 0;
                            var lat = 0;
                            var lon = 0;
                            var count = 0;
                            function centerMap(lat, lon){
                                L.map.center = [lat, lon];
                                L.map.zoom = 15;
                            }
                            {% for halte in haltes %}
                                lat += {{ haltes[halte]['lati'] }};
                                lon += {{ haltes[halte]['longi'] }};

                                // count ++;
                                markers[count] = L.marker([{{ haltes[halte]['lati'] }}, {{ haltes[halte]['longi'] }}]).addTo(map);
                                markers[count].bindPopup("<b>{{halte}}</b><br>{{ haltes[halte]['time'] }}<br>" +
                                    "{{ haltes[halte]['weather'] }}<br>{{ haltes[halte]['temp'] }} Â°C").openPopup();
                                if (count > 0){
                                    calculateRoute(platform, markers[count-1].getLatLng(), markers[count].getLatLng());
                                }
                                count ++;
                            {% endfor %}
                            {% for route in routes %}
                                var pointA = new L.LatLng({{route[0][0]}}, {{route[0][1]}});
                                var pointB = new L.LatLng({{route[1][0]}}, {{route[1][1]}});
                                var pointList = [pointA, pointB];
                                var firstpolyline = new L.Polyline(pointList, {
                                    color: 'blue',
                                    weight: 3,
                                    opacity: 0.5,
                                    smoothFactor: 1
                                });
                                firstpolyline.addTo(map);
                            {% endfor %}
                            centerMap(lat/count, lon/count);
                        </script>
                    <!--</h1>-->
                <!--</div>-->
            <!--</div>-->
        <!--</div>-->
    <!--</div>-->
</header>

<!--<footer>-->
    <!--<div class="container">-->
        <!--<p>&copy; Your Website 2018. All Rights Reserved.</p>-->
        <!--<ul class="list-inline">-->
            <!--<li class="list-inline-item">-->
                <!--<a href="#">Privacy</a>-->
            <!--</li>-->
            <!--<li class="list-inline-item">-->
                <!--<a href="#">Terms</a>-->
            <!--</li>-->
            <!--<li class="list-inline-item">-->
                <!--<a href="#">FAQ</a>-->
            <!--</li>-->
        <!--</ul>-->
    <!--</div>-->
<!--</footer>-->

<!-- Bootstrap core JavaScript -->
<script src="{{ url_for('static', filename='vendor/jquery/jquery.min.js')}}"></script>
<script src="{{ url_for('static', filename='vendor/bootstrap/js/bootstrap.bundle.min.js')}}"></script>

<!-- Plugin JavaScript -->
<script src="{{ url_for('static', filename='vendor/jquery-easing/jquery.easing.min.js')}}"></script>

<!-- Custom scripts for this template -->
<script src="{{ url_for('static', filename='js/new-age.min.js')}}"></script>

</body>

</html>
